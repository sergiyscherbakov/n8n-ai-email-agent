# AI Email Processing Agent –¥–ª—è n8n

![n8n](https://img.shields.io/badge/n8n-latest-FF6D5A?style=for-the-badge&logo=n8n&logoColor=white) ![Node.js](https://img.shields.io/badge/Node.js-18-339933?style=for-the-badge&logo=node.js&logoColor=white) ![OpenAI](https://img.shields.io/badge/OpenAI-GPT--5-412991?style=for-the-badge&logo=openai&logoColor=white)

## –ê–≤—Ç–æ—Ä

**–†–æ–∑—Ä–æ–±–Ω–∏–∫:** –°–µ—Ä–≥—ñ–π –©–µ—Ä–±–∞–∫–æ–≤
**Email:** sergiyscherbakov@ukr.net
**Telegram:** @s_help_2010

### üí∞ –ü—ñ–¥—Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–∑—Ä–æ–±–∫—É
–ó–∞–¥–æ–Ω–∞—Ç–∏—Ç–∏ –Ω–∞ –∫–∞–≤—É USDT (BINANCE SMART CHAIN):
**`0xDFD0A23d2FEd7c1ab8A0F9A4a1F8386832B6f95A`**

---

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –º—ñ—Å—Ç–∏—Ç—å –≥–æ—Ç–æ–≤–∏–π workflow –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –µ–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ—ó –ø–æ—à—Ç–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é AI –∞–≥–µ–Ω—Ç–∞ –≤ n8n.

## –û–ø–∏—Å

Workflow –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
- –æ—Ç—Ä–∏–º—É—î –≤—Ö—ñ–¥–Ω—ñ –ª–∏—Å—Ç–∏ –∑ Gmail
- –∞–Ω–∞–ª—ñ–∑—É—î —ó—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –º–æ–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ (OpenAI GPT)
- –≥–µ–Ω–µ—Ä—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- —Å—Ç–≤–æ—Ä—é—î —á–µ—Ä–Ω–µ—Ç–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π —É Gmail
- –∑–±–µ—Ä—ñ–≥–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —É Google Sheets –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É

## –°—Ö–µ–º–∞ Workflow

Workflow —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –¥–≤–æ—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó:

### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–∞ –æ–±—Ä–æ–±–∫–∞ (Simple Flow)
```
Gmail Trigger ‚Üí AI Agent ‚Üí Create Draft ‚Üí Append to Sheet
                    ‚Üë
                    |
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      |                            |
OpenAI Chat Model          Simple Memory
                                   |
                     Structured Output Parser
```

### –í–∞—Ä—ñ–∞–Ω—Ç 2: –ê–≥–µ–Ω—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ (Advanced Flow)
```
Gmail Trigger ‚Üí AI Agent ‚Üí (–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è)
                    ‚Üë
                    |
      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
      |                            |                  |                    |
OpenAI Chat Model          Simple Memory    Gmail Tool         Google Sheets Tool
                                   |
                     Structured Output Parser
```

## –î–µ—Ç–∞–ª—å–Ω–∏–π –æ–ø–∏—Å –Ω–æ–¥

### 1. Gmail Trigger (–¢—Ä–∏–≥–µ—Ä)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É—î –Ω–æ–≤—ñ –ª–∏—Å—Ç–∏ —É Gmail

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- **Gmail Account**: –ü—ñ–¥–∫–ª—é—á—ñ—Ç—å —Å–≤—ñ–π Gmail –∞–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ OAuth2
- **Poll Times**: –ß–∞—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–æ—à—Ç–∏ (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: —â–æ–¥–Ω—è –æ 20:00)
- **Filters**: –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—ñ–ª—å—Ç—Ä–∏ –¥–ª—è –≤—Ö—ñ–¥–Ω–∏—Ö –ª–∏—Å—Ç—ñ–≤ (–∑–∞ –±–∞–∂–∞–Ω–Ω—è–º)

**–í—Ö—ñ–¥:** –ù–µ–º–∞—î (—Ü–µ —Ç—Ä–∏–≥–µ—Ä)

**–í–∏—Ö—ñ–¥:**
```json
{
  "From": "sender@example.com",
  "Subject": "–¢–µ–º–∞ –ª–∏—Å—Ç–∞",
  "snippet": "–ü–µ—Ä—à—ñ 200 —Å–∏–º–≤–æ–ª—ñ–≤ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è...",
  "threadId": "abc123xyz",
  "messageId": "msg-001"
}
```

---

### 2. AI Agent (–ì–æ–ª–æ–≤–Ω–∏–π –∞–≥–µ–Ω—Ç)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ê–Ω–∞–ª—ñ–∑—É—î –ª–∏—Å—Ç —ñ –≥–µ–Ω–µ—Ä—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**

**Prompt Type:** `define`

**User Message Template:**
```
–¢–µ–º–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: {{ $json.Subject }}
–¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: {{ $json.snippet }}
```

**System Message:**
```
–¢–∏ - –°–µ—Ä–≥—ñ–π –©–µ—Ä–±–∞–∫–æ–≤  –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î—à –Ω–∞ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è, —è–∫—ñ —Ç–æ–±—ñ –ø—Ä–∏—Ö–æ–¥—è—Ç—å –Ω–∞ –ø–æ—à—Ç—É.
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –Ω–∞–¥–∞—î —Ç–æ–±—ñ –¢–µ–º—É —Ç–∞ –¢–µ–∫—Å—Ç –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ —è–∫–µ —Ç—Ä–µ–±–∞ –¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å.
–í–∏–∫–æ–Ω–∞–π –Ω–∞—Å—Ç—É–ø–Ω—ñ –¥—ñ—ó:
1. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–π –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —ñ –Ω–∞–¥–∞–π –Ω–∞ –Ω—å–æ–≥–æ –ø—Ä—è–º–æ–ª—ñ–Ω—ñ–π–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å
2. –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π –≤ –¥–∞–∫–∞–¥–µ–º—ñ—á–Ω–æ–º—É –±–µ–∑–æ—Å–æ–±–æ–≤–æ–º—É —Å—Ç–∏–ª—ñ

–í—ñ–¥–ø–æ–≤—ñ–¥–∞–π –º–æ–≤–æ—é, —è–∫–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ –≤ –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

–í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞–¥–∞–π –≤ –≤–∞–ª—ñ–¥–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ JSON —è–∫–∏–π –º–∞—î –Ω–∞—Å—Ç—É–ø–Ω—É —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
{
  "topic": "–ü—Ä–∏–∫–ª–∞–¥ —Ç–µ–º–∏",
  "message_draft": "–ß–µ—Ä–Ω–µ—Ç–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—É –º–æ–∂–Ω–∞ –±—É–¥–µ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–∞ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏."
}
```

**–©–æ –∑–º—ñ–Ω–∏—Ç–∏:**
- –ó–∞–º—ñ–Ω—ñ—Ç—å "–°–µ—Ä–≥—ñ–π –©–µ—Ä–±–∞–∫–æ–≤" —Ç–∞ –æ–ø–∏—Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –Ω–∞ —Å–≤–æ—ó –¥–∞–Ω—ñ
- –ù–∞–ª–∞—à—Ç—É–π—Ç–µ —Å—Ç–∏–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π –ø—ñ–¥ —Å–≤–æ—ó –ø–æ—Ç—Ä–µ–±–∏
- –ó–∞ –±–∞–∂–∞–Ω–Ω—è–º –¥–æ–¥–∞–π—Ç–µ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó

**–í—Ö—ñ–¥:**
```json
{
  "Subject": "string",
  "snippet": "string"
}
```

**–í–∏—Ö—ñ–¥:**
```json
{
  "output": {
    "topic": "Re: –¢–µ–º–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ",
    "message_draft": "–ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π —Ç–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ"
  }
}
```

---

### 3. OpenAI Chat Model

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ù–∞–¥–∞—î –¥–æ—Å—Ç—É–ø –¥–æ –º–æ–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ OpenAI

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- **Connection**: –î–æ–¥–∞–π—Ç–µ OpenAI API –∫–ª—é—á –≤ Credentials
- **Model**: –û–±–µ—Ä—ñ—Ç—å –º–æ–¥–µ–ª—å (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: `gpt-4` –∞–±–æ `gpt-3.5-turbo`)

**–Ø–∫ –æ—Ç—Ä–∏–º–∞—Ç–∏ API –∫–ª—é—á:**
1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—å –Ω–∞ https://platform.openai.com/
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ API Keys
3. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –∫–ª—é—á
4. –°–∫–æ–ø—ñ—é–π—Ç–µ –π–æ–≥–æ –≤ n8n Credentials

**–í—Ö—ñ–¥:** –ü—ñ–¥'—î–¥–Ω—É—î—Ç—å—Å—è –¥–æ AI Agent —á–µ—Ä–µ–∑ AI connection

**–í–∏—Ö—ñ–¥:** –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –æ–±—Ä–æ–±–∫–∏ –º–æ–¥–µ–ª–ª—é

---

### 4. Simple Memory (Window Buffer Memory)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ó–±–µ—Ä—ñ–≥–∞—î –∫–æ–Ω—Ç–µ–∫—Å—Ç —Ä–æ–∑–º–æ–≤–∏ –¥–ª—è –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- **Session ID Type**: `customKey`
- **Session Key**: `{{ $json.threadId }}` - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î ID —Ç—Ä–µ–¥—É Gmail –¥–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É
- **Context Window Length**: `50` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –≤ —ñ—Å—Ç–æ—Ä—ñ—ó

**–©–æ —Ü–µ –¥–∞—î:**
- –ê–≥–µ–Ω—Ç –ø–∞–º'—è—Ç–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ –ª–∏—Å—Ç–∏ –≤ –æ–¥–Ω–æ–º—É —Ç—Ä–µ–¥—ñ
- –ú–æ–∂–µ –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ —Ä–æ–∑–º–æ–≤—É –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- –ö–æ–∂–µ–Ω —Ç—Ä–µ–¥ –º–∞—î –æ–∫—Ä–µ–º—É –ø–∞–º'—è—Ç—å

**–í—Ö—ñ–¥:** –ü—ñ–¥'—î–¥–Ω—É—î—Ç—å—Å—è –¥–æ AI Agent

**–í–∏—Ö—ñ–¥:** –Ü—Å—Ç–æ—Ä—ñ—è —Ä–æ–∑–º–æ–≤–∏ –¥–ª—è AI Agent

---

### 5. Structured Output Parser

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ó–∞–±–µ–∑–ø–µ—á—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π JSON –≤–∏—Ö—ñ–¥ –≤—ñ–¥ AI

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**

**JSON Schema:**
```json
{
  "topic": "–ü—Ä–∏–∫–ª–∞–¥ —Ç–µ–º–∏",
  "message_draft": "–ß–µ—Ä–Ω–µ—Ç–∫–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, —è–∫—É –º–æ–∂–Ω–∞ –±—É–¥–µ –≤—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–∞ –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏."
}
```

**–©–æ —Ü–µ –¥–∞—î:**
- –ì–∞—Ä–∞–Ω—Ç—É—î, —â–æ AI –∑–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞—î –≤–∞–ª—ñ–¥–Ω–∏–π JSON
- –£–Ω–∏–∫–∞—î –ø–æ–º–∏–ª–æ–∫ –ø–∞—Ä—Å–∏–Ω–≥—É
- –ó–∞–±–µ–∑–ø–µ—á—É—î –æ–¥–Ω–∞–∫–æ–≤–∏–π —Ñ–æ—Ä–º–∞—Ç –≤–∏—Ö–æ–¥—É

**–í—Ö—ñ–¥:** –ü—ñ–¥'—î–¥–Ω—É—î—Ç—å—Å—è –¥–æ AI Agent

**–í–∏—Ö—ñ–¥:** –ü–∞—Ä—Å–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∞–≥–µ–Ω—Ç–∞ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–∏–π JSON

---

### 6. Create a Draft (Gmail)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –°—Ç–≤–æ—Ä—é—î —á–µ—Ä–Ω–µ—Ç–∫—É –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –≤ Gmail

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- **Resource**: `draft`
- **Subject**: `{{ $json.output.topic }}` - —Ç–µ–º–∞ –∑ AI –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
- **Message**: `{{ $json.output.message_draft }}` - —Ç–µ–∫—Å—Ç –∑ AI –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ

**Options:**
- **Reply To**: `{{ $('Gmail Trigger').item.json.From }}` - –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
- **Thread ID**: `{{ $('Gmail Trigger').item.json.threadId }}` - –¥–æ–¥–∞—î –¥–æ —ñ—Å–Ω—É—é—á–æ–≥–æ —Ç—Ä–µ–¥—É
- **Send To**: `{{ $('Gmail Trigger').item.json.From }}` - email –æ—Ç—Ä–∏–º—É–≤–∞—á–∞

**–í—Ö—ñ–¥:**
```json
{
  "output": {
    "topic": "string",
    "message_draft": "string"
  }
}
```

**–í–∏—Ö—ñ–¥:**
```json
{
  "draftId": "draft-001",
  "message": "Draft created successfully"
}
```

---

### 7. Append Row in Sheet (Google Sheets)

**–ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è:** –ó–±–µ—Ä—ñ–≥–∞—î —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –æ–±—Ä–æ–±–ª–µ–Ω—ñ –ª–∏—Å—Ç–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –¥–ª—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
- **Operation**: `append`
- **Document ID**: –í–∞—à Google Sheet ID (–∑–Ω–∞–π–¥—ñ—Ç—å –≤ URL —Ç–∞–±–ª–∏—Ü—ñ)
- **Sheet Name**: –ù–∞–∑–≤–∞ –∞—Ä–∫—É—à—É (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º: –ø–µ—Ä—à–∏–π –∞—Ä–∫—É—à)

**Columns Mapping:**
```javascript
{
  "to": "{{ $('Gmail Trigger').item.json.From }}",      // Email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞
  "draft": "{{ $('AI Agent').item.json.output.message_draft }}"  // –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
}
```

**–Ø–∫ –∑–Ω–∞–π—Ç–∏ Sheet ID:**
URL —Ç–∞–±–ª–∏—Ü—ñ –≤–∏–≥–ª—è–¥–∞—î —Ç–∞–∫:
```
https://docs.google.com/spreadsheets/d/YOUR_SHEET_ID/edit
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ñ:**
| to | draft |
|------|-------|
| sender@example.com | –¢–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ |

**–í—Ö—ñ–¥:**
```json
{
  "to": "string",
  "draft": "string"
}
```

**–í–∏—Ö—ñ–¥:**
```json
{
  "success": true,
  "row": 5
}
```

---

## –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

### –ö—Ä–æ–∫ 1: –Ü–º–ø–æ—Ä—Ç Workflow

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ —Ñ–∞–π–ª `My Agent Personal-3.json`
2. –í—ñ–¥–∫—Ä–∏–π—Ç–µ n8n
3. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ **Workflows** ‚Üí **Import from File**
4. –û–±–µ—Ä—ñ—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π JSON —Ñ–∞–π–ª

### –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Gmail Trigger

1. –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –Ω–æ–¥—É **Gmail Trigger**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Connect Account**
3. –£–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ —Å–≤—ñ–π Gmail –∞–∫–∞—É–Ω—Ç
4. –î–æ–∑–≤–æ–ª—å—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —á–∏—Ç–∞–Ω–Ω—è –ø–æ—à—Ç–∏
5. (–û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ) –ù–∞–ª–∞—à—Ç—É–π—Ç–µ —á–∞—Å –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –≤ **Poll Times**

### –ö—Ä–æ–∫ 3: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è OpenAI

1. –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –Ω–æ–¥—É **OpenAI Chat Model**
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Create New Credential**
3. –í—Å—Ç–∞–≤—Ç–µ –≤–∞—à OpenAI API –∫–ª—é—á
4. –û–±–µ—Ä—ñ—Ç—å –º–æ–¥–µ–ª—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è `gpt-4` –∞–±–æ `gpt-3.5-turbo`)
5. –ó–±–µ—Ä–µ–∂—ñ—Ç—å

### –ö—Ä–æ–∫ 4: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è AI Agent

1. –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –Ω–æ–¥—É **AI Agent**
2. –í **System Message** –∑–∞–º—ñ–Ω—ñ—Ç—å:
   - –Ü–º'—è —Ç–∞ –æ–ø–∏—Å –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
   - –°—Ç–∏–ª—å –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ **User Message Template** –º—ñ—Å—Ç–∏—Ç—å:
   ```
   –¢–µ–º–∞ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: {{ $json.Subject }}
   –¢–µ–∫—Å—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è: {{ $json.snippet }}
   ```

### –ö—Ä–æ–∫ 5: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Google Sheets

1. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É —Ç–∞–±–ª–∏—Ü—é –≤ Google Sheets
2. –î–æ–¥–∞–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏: `to` | `draft`
3. –°–∫–æ–ø—ñ—é–π—Ç–µ Sheet ID –∑ URL
4. –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –Ω–æ–¥—É **Append row in sheet**
5. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å **Connect Account** ‚Üí —É–≤—ñ–π–¥—ñ—Ç—å —á–µ—Ä–µ–∑ Google
6. –í—Å—Ç–∞–≤—Ç–µ –≤–∞—à Sheet ID –≤ **Document ID**
7. –û–±–µ—Ä—ñ—Ç—å –∞—Ä–∫—É—à –≤ **Sheet Name**

### –ö—Ä–æ–∫ 6: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Create a Draft

1. –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –Ω–æ–¥—É **Create a Draft**
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ —Ç–æ–π –∂–µ Gmail –∞–∫–∞—É–Ω—Ç —â–æ —ñ –¥–ª—è Trigger
3. –î–æ–∑–≤–æ–ª—å—Ç–µ –¥–æ—Å—Ç—É–ø –¥–æ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —á–µ—Ä–Ω–µ—Ç–æ–∫

---

## –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ Workflow

### –¢–µ—Å—Ç–æ–≤–∏–π –∑–∞–ø—É—Å–∫

1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –∫–Ω–æ–ø–∫—É **Execute Workflow** –≤ –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω—å–æ–º—É –∫—É—Ç—ñ
2. –ù–∞–¥—ñ—à–ª—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤–∏–π –ª–∏—Å—Ç –Ω–∞ –≤–∞—à Gmail (–∑ —ñ–Ω—à–æ–≥–æ –∞–∫–∞—É–Ω—Ç–∞)
3. –ü–æ—á–µ–∫–∞–π—Ç–µ –Ω–∞ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∞–±–æ –∑–∞–ø—É—Å—Ç—ñ—Ç—å –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ **Execute Workflow**

### –©–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏:

**‚úÖ Gmail Trigger:**
- –û—Ç—Ä–∏–º–∞–≤ –ª–∏—Å—Ç
- –í–∏–¥—ñ–ª–∏–≤ Subject —Ç–∞ snippet
- –ü–µ—Ä–µ–¥–∞–≤ threadId

**‚úÖ AI Agent:**
- –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤ –ª–∏—Å—Ç
- –ó–≥–µ–Ω–µ—Ä—É–≤–∞–≤ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é –º–æ–≤–æ—é
- –ü–æ–≤–µ—Ä–Ω—É–≤ –≤–∞–ª—ñ–¥–Ω–∏–π JSON –∑ topic —Ç–∞ message_draft

**‚úÖ Create a Draft:**
- –°—Ç–≤–æ—Ä–µ–Ω–∞ —á–µ—Ä–Ω–µ—Ç–∫–∞ –≤ Gmail ‚Üí Drafts
- –ß–µ—Ä–Ω–µ—Ç–∫–∞ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ç—Ä–µ–¥—ñ
- Reply to –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π –Ω–∞ –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞

**‚úÖ Google Sheets:**
- –ó'—è–≤–∏–≤—Å—è –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫
- Email –≤—ñ–¥–ø—Ä–∞–≤–Ω–∏–∫–∞ –≤ –∫–æ–ª–æ–Ω—Ü—ñ "to"
- –ó–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –≤ –∫–æ–ª–æ–Ω—Ü—ñ "draft"

### –ü–µ—Ä–µ–≥–ª—è–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤

1. **–í n8n:** –ö–ª—ñ–∫–Ω—ñ—Ç—å –Ω–∞ –∫–æ–∂–Ω—É –Ω–æ–¥—É —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ INPUT/OUTPUT –¥–∞–Ω—ñ
2. **–í Gmail:** –ü–µ—Ä–µ–π–¥—ñ—Ç—å –¥–æ Drafts ‚Üí –∑–Ω–∞–π–¥—ñ—Ç—å —á–µ—Ä–Ω–µ—Ç–∫—É
3. **–í Google Sheets:** –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ç–∞–±–ª–∏—Ü—é ‚Üí –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–æ–≤–∏–π —Ä—è–¥–æ–∫

---

## –ê–∫—Ç–∏–≤–∞—Ü—ñ—è Workflow

–ü—ñ—Å–ª—è —É—Å–ø—ñ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:

1. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –ø–µ—Ä–µ–º–∏–∫–∞—á **Inactive ‚Üí Active** –≤–≥–æ—Ä—ñ
2. Workflow –±—É–¥–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç–∏—Å—å –∑–∞ —Ä–æ–∑–∫–ª–∞–¥–æ–º
3. –î–ª—è –∑—É–ø–∏–Ω–∫–∏: –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å **Active ‚Üí Inactive**

---

## –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ –í–∞—Ä—ñ–∞–Ω—Ç–æ–º 1 —ñ –í–∞—Ä—ñ–∞–Ω—Ç–æ–º 2

### –í–∞—Ä—ñ–∞–Ω—Ç 1 (Simple Flow - –Ω–æ–¥–∏ 1-6)

**–ü—ñ–¥—Ö—ñ–¥:** –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–∞ –æ–±—Ä–æ–±–∫–∞
- AI Agent –≥–µ–Ω–µ—Ä—É—î JSON
- –û–∫—Ä–µ–º—ñ –Ω–æ–¥–∏ —Å—Ç–≤–æ—Ä—é—é—Ç—å draft —ñ –∑–∞–ø–∏—Å—É—é—Ç—å –≤ Sheets
- –ü—Ä–æ—Å—Ç—ñ—à–∞ –ª–æ–≥—ñ–∫–∞, –ª–µ–≥—à–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏

**–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–ª–∏:**
- –í–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–∞ –ø—Ä–æ—Å—Ç–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ—à—Ç–∏
- –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Å–∫–ª–∞–¥–Ω–∞ –ª–æ–≥—ñ–∫–∞
- –í–∏ —Ö–æ—á–µ—Ç–µ –±—ñ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –∫–æ–∂–Ω–∏–º –∫—Ä–æ–∫–æ–º

### –í–∞—Ä—ñ–∞–Ω—Ç 2 (Advanced Flow - –Ω–æ–¥–∏ 7-12)

**–ü—ñ–¥—Ö—ñ–¥:** –ê–≥–µ–Ω—Ç–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –∑ Tools
- AI Agent —Å–∞–º –≤–∏—Ä—ñ—à—É—î –∫–æ–ª–∏ —ñ —â–æ —Ä–æ–±–∏—Ç–∏
- Gmail —ñ Sheets –ø—ñ–¥'—î–¥–Ω–∞–Ω—ñ —è–∫ Tools –¥–æ –∞–≥–µ–Ω—Ç–∞
- –ë—ñ–ª—å—à –≥–Ω—É—á–∫–∞ –ø–æ–≤–µ–¥—ñ–Ω–∫–∞

**–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫–æ–ª–∏:**
- –ü–æ—Ç—Ä—ñ–±–Ω–∞ –¥–∏–Ω–∞–º—ñ—á–Ω–∞ –ª–æ–≥—ñ–∫–∞ (–Ω–µ –∑–∞–≤–∂–¥–∏ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ draft)
- AI –º–∞—î –≤–∏—Ä—ñ—à—É–≤–∞—Ç–∏ —â–æ —Ä–æ–±–∏—Ç–∏
- –ü–æ—Ç—Ä—ñ–±–Ω–∞ —Å–∫–ª–∞–¥–Ω—ñ—à–∞ –æ–±—Ä–æ–±–∫–∞

---

## –¢–∏–ø–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü–æ–º–∏–ª–∫–∞: "Authentication required"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–ø—ñ–¥–∫–ª—é—á—ñ—Ç—å Gmail/Google Sheets –∞–∫–∞—É–Ω—Ç–∏

### –ü–æ–º–∏–ª–∫–∞: "OpenAI API key invalid"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –∫–ª—é—á –Ω–∞ https://platform.openai.com/api-keys

### –ü–æ–º–∏–ª–∫–∞: "JSON parse error"
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ Structured Output Parser –ø—Ä–∞–≤–∏–ª—å–Ω–æ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π

### Draft –Ω–µ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É —Ç—Ä–µ–¥—ñ
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ Thread ID –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è: `{{ $('Gmail Trigger').item.json.threadId }}`

### –î—É–±–ª—é—é—Ç—å—Å—è –∑–∞–ø–∏—Å–∏ –≤ Sheets
**–†—ñ—à–µ–Ω–Ω—è:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Poll Times - –º–æ–∂–ª–∏–≤–æ –∑–∞–Ω–∞–¥—Ç–æ —á–∞—Å—Ç–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î

---

## –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π

### –î–æ–¥–∞—Ç–∏ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—é –ª–∏—Å—Ç—ñ–≤
–í System Message –¥–æ–¥–∞–π—Ç–µ:
```
3. –í–∏–∑–Ω–∞—á –∫–∞—Ç–µ–≥–æ—Ä—ñ—é –ª–∏—Å—Ç–∞: "–∑–∞–ø–∏—Ç–∞–Ω–Ω—è" / "—Å–∫–∞—Ä–≥–∞" / "–ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—è"
```
–í JSON Schema:
```json
{
  "topic": "...",
  "message_draft": "...",
  "category": "–∑–∞–ø–∏—Ç–∞–Ω–Ω—è"
}
```

### –î–æ–¥–∞—Ç–∏ –∞–≤—Ç–æ–≤—ñ–¥–ø—Ä–∞–≤–∫—É
–ó–∞–º—ñ—Å—Ç—å "Create a Draft" –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ –Ω–æ–¥—É **Gmail ‚Üí Send Message**

‚ö†Ô∏è **–£–≤–∞–≥–∞:** –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ workflow —Ä–µ—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥ –∞–≤—Ç–æ–≤—ñ–¥–ø—Ä–∞–≤–∫–æ—é!

### –î–æ–¥–∞—Ç–∏ Telegram —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
–ü—ñ—Å–ª—è AI Agent –¥–æ–¥–∞–π—Ç–µ –Ω–æ–¥—É **Telegram ‚Üí Send Message** –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–ø–æ–≤—ñ—â–µ–Ω—å –ø—Ä–æ –Ω–æ–≤—ñ –ª–∏—Å—Ç–∏

---

## –õ—ñ—Ü–µ–Ω–∑—ñ—è

–¶–µ–π –ø—Ä–æ–µ–∫—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π –¥–ª—è –≤—ñ–ª—å–Ω–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —Ç–∞ –º–æ–¥–∏—Ñ—ñ–∫–∞—Ü—ñ—ó.

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∫–æ–∂–Ω–æ—ó –Ω–æ–¥–∏
2. –ü–æ–¥–∏–≤—ñ—Ç—å—Å—è –ª–æ–≥–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –≤ n8n
3. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é n8n: https://docs.n8n.io/
